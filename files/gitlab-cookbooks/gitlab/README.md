# gitlab Cookbook

Configures the different components needed for an Omnibus installation of GitLab

## Resources

### postgresql_user

Creates a user account in the PostgreSQL instance

#### properties

* 'username': The name of the user to create. Required
* 'password': The password of the account. Optional. This can be the plaintext password, or an md5 hash of the password. The hash can be generated by running `echo -n 'PASSWORD+USERNAME' | md5sum` and should be passed in the form `md5PASSWORD_HASH`.
* 'options': An array of options to enable on the user. Optional. See the [PostgreSQL documentation](https://www.postgresql.org/docs/9.6/static/sql-createuser.html) for the available options
* 'helper': The helper object for interacting with the running database. Default: PgHelper.new(node)

#### example

Create the user 'bar' without a password or any options

```ruby
postgresql_user 'bar'
```

Create the superuser 'bar' with an md5 encoded password
```ruby
postgresql_user 'bar' do
  options %w(SUPERUSER)
  password 'md5........'
end
```

### postgresql_database

Creates a database in the PostgreSQL instance

#### properties

* 'database': The name of the database to create. Required.
* 'owner': The user account that will be the owner of the database. Default: `node['gitlab']['postgresql']['user']`
* 'helper': The helper object for interacting with the running database. Default: PgHelper.new(node)
* 'database_port': The port the database instance is listening on. Default: `node['gitlab']['postgresql']['port']`
* 'database_socket': The directory that the socket file exists in. Default: `node['gitlab']['postgresql']['unix_socket_directory']`

#### example

Create a database called 'foo' owned by the default postgresql user

```ruby
postgresql_database 'foo'
```

Create a database called 'foo' owned by user 'bar'

```ruby
postgresql_database 'foo' do
  owner 'bar'
end
```
